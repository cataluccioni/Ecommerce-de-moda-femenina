<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carrito de Compras</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../CSS/css.css">
</head>
<body>

        <!-- Carrito -->
        <div class="mt-4">
            <h3>Carrito</h3>
            <ul id="lista-carrito" class="list-group">
                <!-- Aquí se agregarán los productos -->
            </ul>
            <hr>
            <p class="text-right">Total: <span id="total">$0</span></p>
        </div>
    </div>

    <!-- Bootstrap JS y dependencias -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <!-- JavaScript personalizado -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const btnAgregar = document.querySelectorAll('.btn-agregar');
            const listaCarrito = document.getElementById('lista-carrito');
            const total = document.getElementById('total');
            let carrito = [];

            // Evento click para agregar productos al carrito
            btnAgregar.forEach(btn => {
                btn.addEventListener('click', function () {
                    const nombre = this.getAttribute('data-nombre');
                    const precio = parseFloat(this.getAttribute('data-precio'));

                    // Agregar producto al arreglo del carrito
                    carrito.push({ nombre, precio });

                    // Actualizar visualización del carrito
                    mostrarCarrito();
                });
            });

            // Función para mostrar los productos en el carrito
            function mostrarCarrito() {
                listaCarrito.innerHTML = '';
                let totalCarrito = 0;

                carrito.forEach((producto, index) => {
                    const { nombre, precio } = producto;
                    const itemCarrito = document.createElement('li');
                    itemCarrito.classList.add('list-group-item', 'd-flex', 'justify-content-between', 'align-items-center');
                    itemCarrito.innerHTML = `
                        ${nombre} - $${precio.toFixed(2)}
                        <button class="btn btn-danger btn-sm eliminar" data-indice="${index}">Eliminar</button>
                    `;
                    listaCarrito.appendChild(itemCarrito);
                    totalCarrito += precio;
                });

                // Actualizar total
                total.textContent = `$${totalCarrito.toFixed(2)}`;

                // Guardar carrito en el almacenamiento local
                localStorage.setItem('carrito', JSON.stringify(carrito));
            }

            // Evento click para eliminar productos del carrito
            listaCarrito.addEventListener('click', function (event) {
                if (event.target.classList.contains('eliminar')) {
                    const indice = parseInt(event.target.getAttribute('data-indice'));
                    carrito.splice(indice, 1);
                    mostrarCarrito();
                }
            });

            // Función para cargar el carrito almacenado localmente al cargar la página
            function cargarCarrito() {
                const carritoGuardado = JSON.parse(localStorage.getItem('carrito'));
                if (carritoGuardado) {
                    carrito = carritoGuardado;
                    mostrarCarrito();
                }
            }

            // Cargar carrito al iniciar la página
            cargarCarrito();
        });
    </script>
</body>
</html>